/**
 * Description:
 * @author Seadon
 * @date 2016年2月23日
 *
 */

idefine(function(require, exports, module) {
	
	//首页加载显示
	jQuery.extend({PageLoading:function(a){function b(){if("complete"==document.readyState){var b=jQuery("#loadingPage");setTimeout(function(){jQuery("#loadingTips .loading-info").text("页面加载完成");jQuery(".modal-backdrop.in").fadeOut(1000).remove();b.animate({opacity:0},a.delayTime,function(){jQuery(this).hide()})},a.sleep)}}var c={opacity:1,borderColor:"#bbb",borderWidth:1,borderStyle:"solid",loadingTips:"努力加载中...",TipsColor:"#666",delayTime:1e3,zindex:9999,sleep:0},a=jQuery.extend(c,a),d=document.documentElement.clientHeight,e=document.documentElement.clientWidth,f='<div id="loadingPage" style="position:fixed;left:0;top:0;_position: absolute;width:100%;height:'+d+"px;background:"+a.backgroundColor+";opacity:"+a.opacity+";filter:alpha(opacity="+100*a.opacity+");z-index:"+a.zindex+';"><div id="loadingTips" style="position: absolute; cursor1: wait; width: auto;border-color:'+a.borderColor+";border-style:"+a.borderStyle+";border-width:"+a.borderWidth+"px; height:160px; line-height:100px; padding: 30px 20px;border-radius:10px; background:#fff; color:"+a.TipsColor+';font-size:20px;">'+'<div class="loadings">\n<span></span>\n<span></span>\n<span></span>\n<span></span>\n<span></span>\n</div><span class="loading-info">'+a.loadingTips+"</span></div></div><div class='modal-backdrop fade in'></div>";jQuery("body").append(f);var g=document.getElementById("loadingTips").clientHeight,h=document.getElementById("loadingTips").clientWidth,i=d>g?(d-g)/2:0,j=e>h?(e-h)/2:0;jQuery("#loadingTips").css({left:j+"px",top:i+"px"}),document.onreadystatechange=b}});
	
	//时间显示
	jQuery.fn.extend({timeShow:function(options){var defaults={txtColor:"",YMColor:"",DColor:"",WColor:"",yearMoon:"#yearMoon",dayShow:"#dayShow",weekShow:"#weekShow"};options=jQuery.extend(defaults,options);return this.each(function(){var o=options;var timeShowTxt=jQuery(this).attr("id");jQuery("#"+timeShowTxt).css({color:o.txtColor});jQuery(o.yearMoon).css({color:o.YMColor});jQuery(o.dayShow).css({color:o.DColor});jQuery(o.weekShow).css({color:o.WColor});startTime();function startTime(){var today=new Date();var w;switch(today.getDay()){case 1:w="星期一";break;case 2:w="星期二";break;case 3:w="星期三";break;case 4:w="星期四";break;case 5:w="星期五";break;case 6:w="星期六";break;default:w="星期日"}var y=today.getFullYear();var _m=today.getMonth()+1;var d=today.getDate();var h=today.getHours();var m=today.getMinutes();var s=today.getSeconds();m=checkTime(m);s=checkTime(s);jQuery("#"+timeShowTxt).html(h+":"+m+":"+s+" ");jQuery(o.weekShow).append(w);jQuery(o.dayShow).prepend(d+"日 ");jQuery(o.yearMoon).prepend(y+"年"+_m+"月");t=setTimeout(startTime,1000)}function checkTime(i){if(i<10){i="0"+i}return i}})}});

	//进度条
	!function(t){function s(){var t,s=document.createElement("fakeelement"),o={transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"};for(t in o)if(void 0!==s.style[t])return o[t]}var o=s();t.ToProgress=function(t,s){if(this.progress=0,this.options={id:"i-progress-bar",color:"#F44336",height:"2px",duration:.3},t&&"object"==typeof t)for(var o in t)this.options[o]=t[o];if(this.options.opacityDuration=3*this.options.duration,this.progressBar=document.createElement("div"),this.progressBar.id=this.options.id,this.progressBar.setCSS=function(t){for(var s in t)this.style[s]=t[s]},this.progressBar.setCSS({position:s?"relative":"fixed",top:"0",left:"0",right:"0","box-shadow":"0 0 8px rgba(244,67,54,0.7)","z-index":"1003","background-color":this.options.color,height:this.options.height,width:"0%",transition:"width "+this.options.duration+"s, opacity "+this.options.opacityDuration+"s","-moz-transition":"width "+this.options.duration+"s, opacity "+this.options.opacityDuration+"s","-webkit-transition":"width "+this.options.duration+"s, opacity "+this.options.opacityDuration+"s"}),s){var i=document.querySelector(s);i&&(i.hasChildNodes()?i.insertBefore(this.progressBar,i.firstChild):i.appendChild(this.progressBar))}else document.body.appendChild(this.progressBar)},ToProgress.prototype.transit=function(){this.progressBar.style.width=this.progress+"%"},ToProgress.prototype.getProgress=function(){return this.progress},ToProgress.prototype.setProgress=function(t,s){this.show(),this.progress=t>100?100:0>t?0:t,this.transit(),s&&s()},ToProgress.prototype.increase=function(t,s){this.show(),this.setProgress(this.progress+t,s)},ToProgress.prototype.decrease=function(t,s){this.show(),this.setProgress(this.progress-t,s)},ToProgress.prototype.finish=function(t){var s=this;this.setProgress(100,t),this.hide(),o&&this.progressBar.addEventListener(o,function(t){s.reset(),s.progressBar.removeEventListener(t.type,arguments.callee)})},ToProgress.prototype.reset=function(t){this.progress=0,this.transit(),t&&t()},ToProgress.prototype.hide=function(){this.progressBar.style.opacity="0"},ToProgress.prototype.show=function(){this.progressBar.style.opacity="1"}}(window);

	//加载进度条初始化
	var pg=new ToProgress();function pgf(){pg.reset();var pgs=setInterval(function(){if(pg.getProgress()<89){pg.increase(1)}if(pg.getProgress()>=89){pg.increase(0.1)}if(pg.getProgress()==100){clearInterval(pgs);pg.finish()}},300);};window.i_web_pg=pg;
	
	//bootstrap-tab 动态处理
	!function($){$.fn.multabs=function(a){obj=$(this),Multab.options=$.extend({content:"",close:!0,monitor:"body",iframeUse:!0,iframeHeight:$(window).height()-150,method:"init",callback:function(){}},a||{}),$(Multab.options.monitor).on("click","[data-menu]",function(){Multab.add({id:$(this).attr("data-menu"),title:$(this).attr("title")?$(this).attr("title"):$(this).html().replace(/<b.*\/b>/g,""),content:Multab.options.content?Multab.options.content:$(this).attr("content"),url:$(this).data("url"),ajax:$(this).attr("ajax")?!0:!1})}),obj.on("click",".i-close-tab",function(){var a=$(this).prev("a").attr("aria-controls");Multab.close(a)}),obj.on("mouseenter",".i-close-tab",function(){$(this).removeClass("glyphicon-remove").addClass("glyphicon-remove-circle")}),obj.on("mouseleave",".i-close-tab",function(){$(this).removeClass("glyphicon-remove-circle").addClass("glyphicon-remove")}),$(window).resize(function(){obj.find("iframe").attr("height",Multab.options.iframeHeight),Multab.drop()})}}(jQuery),function($){window.Multab={options:{},add:function(a){var b="tab_"+a.id;if(obj.find(".active").removeClass("active"),!$("#"+b)[0]){var c=$("<li>",{role:"presentation",id:"tab_"+b}).append($("<a>",{href:"#"+b,"aria-controls":b,role:"tab","data-toggle":"tab"}).html(a.title));Multab.options.close&&c.append($("<i>",{"class":"i-close-tab glyphicon glyphicon-remove"}));var d=$("<div>",{"class":"tab-pane i-tabs",id:b,role:"tabpanel"});a.content?d.append(a.content):Multab.options.iframeUse&&!a.ajax?(function(){pgf();d.append($("<iframe>",{"class":"i-iframe",height:Multab.options.iframeHeight,frameborder:"no",border:"0",src:a.url}))})():$.get(a.url,function(a){d.append(a)}),obj.children(".nav-tabs").append(c),obj.children(".tab-content").append(d)}$("#banner").hide(),$("#tab_"+b).addClass("active"),$("#"+b).addClass("active"),Multab.drop()},close:function(a){obj.find("li.active").attr("id")=="tab_"+a&&($("#tab_"+a).prev().addClass("active"),$("#"+a).prev().addClass("active")),$("#tab_"+a).remove(),$("#"+a).remove(),Multab.drop(),Multab.options.callback()},drop:function(){element=obj.find(".nav-tabs");var a=$("<li>",{"class":"dropdown pull-right hide tabdrop"}).append($("<a>",{"class":"dropdown-toggle","data-toggle":"dropdown",href:"#"}).append($("<i>",{"class":"glyphicon glyphicon-align-justify"})).append($("<b>",{"class":"caret"}))).append($("<ul>",{"class":"dropdown-menu"}));$(".tabdrop").html()?a=element.find(".tabdrop"):a.prependTo(element),element.parent().is(".tabs-below")&&a.addClass("dropup");var b=0;element.append(a.find("li")).find(">li").not(".tabdrop").each(function(){(this.offsetTop>0||element.width()-$(this).position().left-$(this).width()<53)&&(a.find("ul").append($(this)),b++)}),b>0?(a.removeClass("hide"),1==a.find(".active").length?a.addClass("active"):a.removeClass("active")):a.addClass("hide")}};}(jQuery);
	
	//数字滚动动画
	jQuery.fn.countTo=function(a){return a=a||{},jQuery(this).each(function(){function b(){j+=f,i++,c(j),i>=e&&(h.removeData("countTo"),clearInterval(k.interval),j=d.to)}function c(a){var b=d.formatter.call(g,a);h.html(b)}var d=jQuery.extend({},{from:jQuery(this).data("from")||0,to:jQuery(this).data("to")||0,speed:jQuery(this).data("speed")||1500,refreshInterval:jQuery(this).data("refresh-interval")||100,decimals:jQuery(this).data("decimals")||0,formatter:function(){return j.toFixed(d.decimals).replace(/\B(?=(?:\d{3})+(?!\d))/g,",")}},a),e=Math.ceil(d.speed/d.refreshInterval),f=(d.to-d.from)/e,g=this,h=jQuery(this),i=0,j=d.from,k=h.data("countTo")||{};h.data("countTo",k),k.interval&&clearInterval(k.interval),k.interval=setInterval(b,d.refreshInterval),c(j)})};

	//弹出全屏
	!function(a){a.fn.fullscreen=function(o){function n(){l.css({"z-index":i.zIndexOut}),i.afterClose()}function t(){i.afterOpen()}var e=a(this),i=a.extend({modalTarget:"fullScreen",position:"fixed",width:"100%",height:"100%",top:"0px",left:"0px",padding:"20px",zIndexIn:"1001",zIndexOut:"-1001",color:"#f2f7f8",opacityIn:"1",opacityOut:"0",animatedIn:"zoomIn",animatedOut:"zoomOut",animationDuration:".6s",overflow:"auto",beforeOpen:function(){},afterOpen:function(){},beforeClose:function(){},afterClose:function(){}},o),d=a(".i-close-"+i.modalTarget),s=a(e).attr("href"),l=a("body").find("#"+i.modalTarget),m="#"+l.attr("id");l.addClass("animated"),l.addClass(i.modalTarget+"-off");var r={position:i.position,width:i.width,height:i.height,top:i.top,left:i.left,"background-color":i.color,"padding":i.padding,"overflow-y":i.overflow,"z-index":i.zIndexOut,opacity:i.opacityOut,"-webkit-animation-duration":i.animationDuration};l.css(r),e.click(function(o){o.preventDefault(),a("body, html").css({overflow:"hidden"}),s==m&&(l.hasClass(i.modalTarget+"-off")&&(l.removeClass(i.animatedOut),l.removeClass(i.modalTarget+"-off"),l.addClass(i.modalTarget+"-on")),l.hasClass(i.modalTarget+"-on")&&(i.beforeOpen(),l.css({opacity:i.opacityIn,"z-index":i.zIndexIn}),l.addClass(i.animatedIn),l.one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",t)))}),d.click(function(o){o.preventDefault(),a("body, html").css({overflow:"auto"}),i.beforeClose(),l.hasClass(i.modalTarget+"-on")&&(l.removeClass(i.modalTarget+"-on"),l.addClass(i.modalTarget+"-off")),l.hasClass(i.modalTarget+"-off")&&(l.removeClass(i.animatedIn),l.addClass(i.animatedOut),l.one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",n))})}}(jQuery);

});